<div class="policy-grid {{#if selectedPolicy}}has-selected{{/if}}">
    {{#policies}}
        <div class="policy-grid__item {{#if this == selectedPolicy}}is-selected{{/if}} js-party js-party-{{party.toLowerCase()}}">
            <p class="policy-grid__item__party policy-grid__item__party--{{party.toLowerCase()}}">{{party}}</p>
            <h4 class="policy-grid__item__title">{{policy}}</h4>
            {{#if this == selectedPolicy}}
                <p class="policy-grid__item__share">
                    <button on-click="share:twitter" class="share share--twitter"></button>
                    <button on-click="share:facebook" class="share share--facebook"></button>
                </p>
                <p>{{policyverbatim}}</p>
            {{/if}}
            <a class="policy-grid__item__link" href="#" title="Read more about this policy" on-click="toggle"></a>
            <p class="policy-grid__item__toggle-selected"></p>
            {{#if this == selectedPolicy}}
                <p><a class="policy-grid__item__source button button--small button--tertiary" href="{{source}}" target="_blank">Source</a></p>
                {{#if commentary}}
                    <p class="policy-grid__item__commentary">
                        <img src="@@assets@@/imgs/people/{{commentaryinitials}}.jpg">
                        <b>{{commentaryname}}</b>: {{commentary}}
                    </p>
                {{/if}}
            {{/if}}
        </div>
    {{/policies}}
</div>

<script>
    component.exports = {
        'isolated': true,
        'data': {
            'selectedPolicy': undefined
        },
        'onrender': function () {
            this.on('toggle', function (evt) {
                var policy = evt.context;
                this.set('selectedPolicy', policy === this.get('selectedPolicy') ? undefined : policy);
                return false;
            });

            this.on('close', function () {
                this.set('selectedPolicy', undefined);
            });
        }
    };
</script>
